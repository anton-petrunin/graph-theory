\chapter{Rado graph}

In this chapter we consider one graph with many surprising properties.
Unlike the most of the graphs we considered so far, this graph has infinite set of vertexes.

\section*{Definition}

Recall that a set is countable if it can be enumerated by natural numbers $1,2,\dots$;
it might be infinite or finite.

A \index{countable graph}\emph{countable graphs} is a graphs with countable set of vertexes;
the set of vertexes can be infinite or finite, but it can not be empty since we always assume that a graph has nonempty set of vertexes.


\begin{thm}{Definition}
A \index{Rado graph}\emph{Rado graph} is a countable graph satisfying the following property:

Given two finite disjoint sets of vertexes $V$ and $W$, there exists a
vertex $v\notin V\cup W$ that is adjacent to any vertex in $V$ and nonadjacent to any vertex in $W$.
\end{thm}

The property in the definition will be called \index{Rado property}\emph{Rado property}; so we can say that \emph{for the sets of vertexes $V$ and $W$ in a graph the Rado property holds} or \emph{does not hold}.

\begin{thm}{Exercise}
Show that any Rado graph has infinite number of vertexes. 
\end{thm}

\begin{thm}{Exercise}
Show that any Rado graph has diameter 2.
\end{thm}

\section*{Stability}

The following exercises show that Rado propery is very stable --- 
small changes can not destroy the Rado property.


\begin{thm}{Exercise}
Let $R$ be a countable graph. 
\begin{enumerate}[(a)]
 \item Assume  $e$ is an edge in $R$. 
 Show that $R-e$ is a Rado graph if and only is so is $R$.
 
 \item Assume $v$ is a vertex in $R$. 
 Show that $R-v$ is a Rado graph if so is $R$.
 
 \item Assume $v$ is a vertex in $R$. 
 Consider the graph $R'$ obtained from $R$ by replacing each edge from $v$ by a non-edge, and each non-edge from $v$ by an edge (leaving the rest unchanged).
 Show that $R'$ is a Rado graph if and only is so is $R$. 
\end{enumerate}

\end{thm}

\begin{thm}{Exercise}
Assume the set of vertexes of a Rado graph is partitioned into two subsets.
Show that the subgraph induced by one of these subsets is Rado.
\end{thm}

\parit{Hint:} Let $P$ and $Q$ be the induced subgraphs in the Rado graph $R$.
Assume $P$ is not Rado; that is, there is a pair of finite vertex sets $V$ and $W$ in $P$ such that any the vertex $v$ in $R$ that meet the Rado property for $V$ and $W$ does not lie in $P$ (and therefore it lies in~$Q$).
Use the pair of sets $V$ and $W$ to show that $Q$ is Rado.

\begin{thm}{Exercise}
Let $R$ be a Rado graph.
Assume that $Z$ is the set of all vertexes in $R$ adjacent to a given vertex $z$.
Show that the subgraph induced by $Z$ is Rado.
\end{thm}


\section*{Existence}

\begin{thm}{Theorem}
There is a Rado graph.
\end{thm}

\parit{Proof.}
Let $G$ be a finite graph; assume it has $p$ vertexes.
Let $G'$ be a graph obtained from $G$ by adding $2^p$ vertexes to $G$ --- we add one vertex $v$ for each of $2^p$ subsets $V$ of vertexes of $G$ and connect $v$ to each vertex in~$V$.

The original graph $G$ is an induced subgraph in the obtained graph $G'$.
Clearly $G'$ has $p+2^p$ vertexes; therefore $G'$ is finite.

By construction, the Rado property holds in $G'$ for any two sets $V$ and $W$ of vertexes in $G$ --- the required vertex $v$ is the vertex in $G'$ that corresponds to the subset $V$.

Let $G_1$ be a graph with one vertex.
\begin{figure}[h!]%{r}{20 mm}
\vskip-0mm
\centering
\includegraphics{mppics/pic-2}
\vskip-0mm
\end{figure}
Repeating the construction we get an sequence of graphs 
$G_1, G_2,G_3,\dots$,
such that $G_{n+1}=G_n'$ for any~$n$.
The graphs $G_1, G_2,G_3$ are shown on the diagram.%
\footnote{It would be hard to draw $G_4$ since it contains $1+2^1+2^{3}+2^{11}=2059$ vertexes and 
it is impossible to draw $G_5$ --- it has $1+2^1\z+2^{3}\z+2^{11}+2^{2059}$ vertexes which exceeds by many orders the number of particles in the observable universe.}

Since $G_n$ is a subgraph of $G_{n+1}$ for any $n$, we can consider the union of the graphs in the sequence $(G_n)$; denote it by $R$.
By construction, each graphs $G_n$ is a subgraph $R$ induced by finitely many vertexes.
Moreover,  any vertex or edge of $R$ belongs any $G_n$ with sufficiently large~$n$.

Note that $R$ is Rado.
Indeed, any two finite sets of vertexes $V$ and $W$ belong to $G_n$ for some $n$.
From above the Rado property holds for $V$ and $W$ in $G_{n+1}$ and therefore in $R$.
\qeds

\parbf{Another construction.}
One could also construct a Rado graph directly specifying which vertexes are adjacent.
Namely, consider the graph $R$ as on the diagram with vertexes $r_0,r_1,\dots$
\begin{figure}[h!]%{r}{45 mm}
\centering
\begin{lpic}[t(-0 mm),b(0 mm),r(0 mm),l(0 mm)]{pics/Rado_graph(.5)}
\lbl[]{5.5,39;$r_0$}
\lbl[]{24.5,39;$r_1$}
\lbl[]{43.5,39;$r_2$}
\lbl[]{62.5,39;$r_3$}
\lbl[]{81.6,39;$r_4$}
\lbl[]{100.7,39;$r_5$}
\lbl[]{119.8,39;$r_6$}
\lbl[]{138.9,39;$r_7$}
\lbl[]{158,39;$r_8$}
\end{lpic}
\end{figure}
such that $r_i$ is adjacent to $r_j$ for some $i<j$ if the $i$-th bit of the binary representation of $j$ is 1.

For instance,  vertex $r_0$ is adjacent to all $r_n$ with odd $n$, because the numbers whose 0-th bit is nonzero are exactly the odd numbers;
vertex $r_1$ is adjacent to $r_0$ (since 1 is odd) and to all $r_n$ with $n\equiv 2$ or $3 \pmod 4$;
and so on.

\begin{thm}{Exercise}
Show that the described graph is Rado.
\end{thm}


\section*{Uniqueness}

In this section we will prove that any two Rado graphs are isomorphic, so essentially there is only one Rado graph.
First let us prove a simpler statement.

\begin{thm}{Theorem}\label{thm:rado-subgraph}
Let $R$ be a Rado graph.
Then any countable graph $G$ (finite or infinite) is isomorphic to a induced subgraph of $R$. 
\end{thm}

\parit{Proof.}
Enumerate the vertexes of $G$ as $v_1 , v_2 , \dots$ (the sequence might be finite or infinite).

It is sufficient to construct a sequence $r_1,r_2,\dots$ of vertexes in $R$ such that $r_i$ is adjacent to $r_j$ if and only if $v_i$ is adjacent to $v_j$.
In this case the graph $G$ is isomorphic to the subgraph of $R$ induced by $\{r_1,r_2\dots\}$.

We may choose any vertex of $R$ as $r_1$.
Suppose that the sequence $r_1,\dots,r_n$ is constructed.
If $G$ has $n$ vertexes, then the required sequence is already constructed.
Otherwise note that Rado property implies that there is a vertex $r_{n+1}$ in $R$ that for any $i\in\{1,\dots,n\}$, it is adjacent to $r_i$ if and only if $v_{n+1}$ is adjacent to $v_i$.

Clearly the new vertex $r_{n+1}$ meets all the required properties.
Repeating this procedure infinitely many times or untill the sequence $(v_n)$ terminates produces the requred sequence $(r_n)$.
\qeds


%\begin{thm}{Exercise} Show that any two vertexes in a Rado graph can be connected by a path of length 10. \end{thm}???


\begin{thm}{Theorem}
Any two Rado graphs $R$ and $S$ are isomorphic.

Moreover any isomorphism $f_0\:S_0\to R_0$ between finite induced subgraphs in $R$ and $S$ can be extended to an isomorphism $f\:S\z\to R$.
\end{thm}

Note that Theorem~\ref{thm:rado-subgraph} implies that $R$ is isomorphic to an induced subgraph in $S$ and the other way around --- $S$ is isomorphic to an induced subgraph in $R$.
For finite graphs these two properties would imply that the graphs are isomorphic, see Exercise~\ref{ex:finite-subgraphs}.
As the following example shows, it does not hold for infinite graphs.
It is instructive to understand this example before going into the proof.

\begin{figure}[h!]%{r}{20 mm}
\vskip-0mm
\centering
\includegraphics{mppics/pic-1}
\vskip-0mm
\end{figure}
 
The first graph $T$ on the diagram has infinite number of vertexes, non of which has degree 3;
the second graph $T'$ one has exactly one vertex of degree 3. 
Therefore these two graphs are not isomorphic.

Deleting the marked vertexes from one graph produces the other one. 
Therefore $T$ is isomorphic to a subgraph of $T'$ and the other way around.

The proof below uses the same construction as in the proof of Theorem~\ref{thm:rado-subgraph}, but it is applied back and forth to ensure that the constructed subgraphs contain all the vertexes of the original graph.


\parit{Proof.}
Once we have proved the second statement,
the first statement will follow if you apply it to single-vertex subgraphs $R_0$ and $S_0$.

Since the graphs are countable,
we can enumerate the vertexes of $R$ and $S$, as $r_1 , r_2 , \dots$ and $s_1, s_2,\dots$ respectively. 
We will construct a sequence of induced subgraphs $R_n$ in $R$ and $S_n$ in $S$ with isomorphisms $f_n\:R_n\to S_n$.

Suppose that an isomorphism $f_n\:R_n\to S_n$ is constructed. 

If $n$ is even, set $m$ to be the smallest index such that $r_m$ not in $R_n$.
The Rado property guarantees that there is a vertex $s_k$ such that for any vertex $r_i$ in $R_n$, $s_k$ is adjacent to $f_n(r_i)$ if and only if $r_m$ is adjacent to $r_i$.
Set $R_{n+1}$ to be the graph induced by vertexes of $R_n$ and $r_m$;
further set $S_{n+1}$ to be the graph induced by vertexes of $S_n$ and $s_k$.
The isomorphism $f_n$ can be extended to an isomorphism $f_{n+1}\:R_{n+1}\to S_{n+1}$ by
setting $f_{n+1}(r_m)=s_k$.  

If $n$ is odd, we do the same backwards.
Let $m$ be the smallest index such that $s_m$ not in $S_n$.
The Rado property guarantees that there is a vertex $r_k$ which is adjacent to a vertex $r_i$ in $R_n$ if and only if $f_n(r_i)$ is adjacent to $s_m$.
Set $R_{n+1}$ to be the graph induced by vertexes of $R_n$ and $r_k$;
further set $S_{n+1}$ to be the graph induced by vertexes of $S_n$ and $s_m$.
The isomorphism $f_n$ can be extended to an isomorphism $f_{n+1}\:R_{n+1}\to S_{n+1}$ by
setting $f_{n+1}(r_k)=s_m$.

Note that if $f_n(r_i)=s_j$ then $f_m(r_i)=s_j$ for all $m\ge n$.
Therefore we can define $f(r_i)=s_j$ if $f_n(r_i)=s_j$ for some $n$.


By construction we get that 
\begin{itemize}
\item $f_n(r_i)$ is defined for any $n>2\cdot i$ therefore $f$ is defined at any vertex of $R$.
\item $s_j$ lies in the range of $f_n$ for any $n>2\cdot j$.
Therefore range of $f$ contains all the vertexes of $S$.
\item $r_i$ is adjacent to $r_j$ if and only if $f(r_i)$ is adjacent to $f(r_j)$.
\end{itemize}
Therefore $f\:R\to S$ is an isomorphism.
\qeds

\begin{thm}{Exercise}
Explain how to modify the proof of theorem above to prove the following theorem.
\end{thm}


\begin{thm}{Theorem}
Let $R$ be a Rado graph.
A countable graph $G$ is isomorphic to a spanning subgraph of $R$ if and only if, given any finite set $V$ of vertexes of $G$, there is a vertex $w$ that is not adjacent to any vertex in $V$.
\end{thm}

\begin{thm}{Exercise}
Let $v$ and $w$ be two vertexes in a Rado graph $R$.
Show that there is an isomorphism from $R$ to itself that sends $v$ to $w$.
\end{thm}

\begin{thm}{Exercise}\label{ex:finite-subgraphs}
Let $G$ and $H$ be two finite graphs.
Assume $G$ is isomorphic to a subgraph of $H$ 
and the other way around --- $H$ is isomorphic to a subgraph of $G$.
Show that $G$ is isomorphic to $H$.
\end{thm}


\section*{The random graph}

The following theorem explains why Rado graph is also named {}\emph{random graph}.

\begin{thm}{Theorem}\label{thm:the-random-graph}
Assume an infinite countable graph is chosen at random, by selecting edges independently with probability $\tfrac12$ from the set of 2-element subsets of the vertex set.
Then, with probability 1, the resulting graph is the Rado graph.
\end{thm}

\parit{Proof.}
It is sufficient to show that for given two finite sets of vertexes $V$ and $W$, the Rado property fails with probability 0.

Assume $n=|V|+|W|$; that is, $n$ is the total number of vertexes in $V$ and $W$.
The probability that a given vertex $v$ outside of $V$ and $W$ satisfy the Rado property for $V$ and $W$
is $\tfrac1{2^n}$.
Therefore probability that a given vertex $v$ does {}\emph{not} satisfy this property
is $1-\tfrac1{2^n}$.

Note that events that a given vertex does not satisfy the property are independent.
Therefore probability that $N$ different vertexes $v_1,\dots,v_N$ outside of $V$ and $W$ do not satisfy the Rado property for $V$ and $W$ is 
\[(1-\tfrac1{2^n})^N\]
This value tends to 0 as $N \to \infty$; 
therefore the event that no vertex is correctly joined has probability 0.
\qeds

\begin{thm}{Exercise}
Let $0<\alpha<1$.
Assume an infinite countable graph is chosen at random, by selecting edges independently with probability $\alpha$ from the set of 2-element subsets of the vertex set.
Show that with probability 1, the resulting graph is the Rado graph.
\end{thm}

\section*{Remarks}

The {}\emph{Rado graph} is also called \emph{Erd\H{o}s–R\'enyi graph} or \emph{random graph};
it was first discovered by Wilhelm Ackermann, rediscovered later by
Paul Erd\H{o}s and Alfr\'ed R\'enyi and yet latter by Richard Rado. 
Theorem \ref{thm:the-random-graph} was discovered by Paul Erd\H{o}s and Alfr\'ed R\'enyi.
A good survey on the subject is written by Peter Cameron~\cite{cameron}.


