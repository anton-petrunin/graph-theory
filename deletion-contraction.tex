\chapter{Deletion and contraction}
\label{Deletion and contraction}

\section{Definitions}


\begin{wrapfigure}{r}{40 mm}
\vskip-12mm
\centering
\includegraphics{mppics/pic-31}
\vskip-0mm
\end{wrapfigure}

Let $G$ be a pseudograph with a marked edge~$e$.
Denote by $G- e$ the pseudograph obtained from $G$ by deleting $e$,
and by $G/e$ the pseudograph obtained from $G$ by contracting the edge $e$ to a point; see diagram.

Assume $G$ is a graph; that is, $G$ has no loops and no parallel edges.
In this case, $G- e$ is also a graph.
However, $G/e$ might have parallel edges, but no loops; that is, $G/e$ is a multigraph.

If $G$ is a multigraph, then so is $G- e$.
If the edge $e$ is parallel to $f$ in $G$, then $f$ in $G/e$ becomes a loop; that is, $G/e$ is a pseudograph in general.


\section{Number of spanning trees}

Recall that $s(G)$ denotes the number of spanning trees in the pseudograph $G$.

{
\begin{wrapfigure}{o}{42 mm}
\vskip-4mm
\centering
\includegraphics{mppics/pic-32}
\vskip-0mm
\end{wrapfigure}

An edge $e$ in a connected graph $G$ is called the \index{bridge}\emph{bridge}, if deletion of $e$ makes the graph disconnected;
in this case, the remaining graph has two connected components which are called \index{bank}\emph{banks}.


\begin{thm}{Exercise}\label{ex:bridge}
Assume that the graph $G$ contains a bridge between banks $H_1$ and $H_2$.
Show that
\[s(G)=s(H_1)\cdot s(H_2).\]
\end{thm}

}


\begin{thm}{Deletion-plus-contraction formula}\index{deletion-plus-contraction formula}
\label{thm:deletion-plus-contraction}
Let $e$ be an edge in the pseudograph $G$.
Assume $e$ is not a loop, then the following identity holds
\[s(G)=s(G- e)+s(G/e).\eqlbl{eq:deletion-plus-contraction}\]

\end{thm}

{

\begin{wrapfigure}{r}{43 mm}
\vskip-12mm
\centering
\includegraphics{mppics/pic-33}
\vskip-0mm
\end{wrapfigure}

It is convenient to write the identity \ref{eq:deletion-plus-contraction} using a diagram as on the picture; the arrows point from one multigraph to multigraphs with the same total number of spanning trees;
the edge $e$ is marked in~$G$.

}

\parit{Proof.} Note that the spanning trees of $G$ can be subdivided into two groups:
(1)~those which contain the edge $e$ and (2)~those which do not.
For the trees in the first group, the contraction of $e$ to a point  gives a spanning tree in~$G/e$, while the trees in the second group are also spanning trees in~$G- e$.

Moreover, both of the described correspondences are one-to-one.
Hence the formula follows.
\qeds

A spanning tree cannot have loops, so removing all loops does not change the number of spanning trees.
Let us state it.

\begin{thm}{Claim}
If $e$ is a loop in a pseudograph $G$, then 
\[s(G)=s(G- e).\]

\end{thm}

The proof of the following claim uses the deletion-plus-contraction formula.

\begin{thm}{Claim}
If one removes an end vertex $w$ from a pseudograph $G$, then in the obtained graph $G- w$
the number of spanning trees remains unchanged;
that is,
\[s(G)=s(G- w).\eqlbl{eq:deletion-plus-contraction-w}\]

\end{thm}

\parit{Proof.}
Denote by $e$ the only edge incident to $w$. 
Note that the graph $G- e$ is not connected, since the vertex $w$ is isolated.
In particular,
$s(G- e)=0$.
On the other hand, $G/e=G- w$.
Therefore, the deletion-plus-contraction formula \ref{eq:deletion-plus-contraction} implies~\ref{eq:deletion-plus-contraction-w}.
\qeds

On the diagrams, we may use a two-sided arrow ``$\leftrightarrow$'' for the graphs with equal numbers of the spanning trees.
For example, using the deletion-plus-contraction formula together with the claims, we can draw the following diagram, which in particular implies the following identity:
\[s(G)=2\cdot s(H).\]

\begin{wrapfigure}{o}{58 mm}
\vskip-0mm
\centering
\includegraphics{mppics/pic-34}
\vskip-0mm
\end{wrapfigure}

Note that the deletion-plus-contraction formula gives an algorithm to calculate  the value $s(G)$ for a given pseudograph $G$.
Indeed, for any edge $e$, both graphs $G- e$ and $G/e$ have a smaller number of edges.
That is, the deletion-plus-contraction formula reduces the problem of finding the number of the trees to simpler graphs;
applying this formula a few times we can reduce the question to a collection of graphs with an evident answer for each.
In the next section we will show how it works.


 
\section{Fans and their relatives}



Recall that \index{Fibonacci numbers}\emph{Fibonacci numbers} $f_n$ are defined using the recursive identity 
$f_{n+1}=f_n+f_{n-1}$
with $f_1=f_2=1$.
The sequence of Fibonacci numbers starts as
\[1,1,2,3,5,8,13,\dots\]

The graphs of the following type are called \label{page:fan}\index{fan}\emph{fans}; 
\begin{figure}[ht!]
\centering
\includegraphics{mppics/pic-35}
\end{figure}
a fan with $n+1$ vertex will be denoted by $F_n$. 

\begin{thm}{Theorem}\label{thm:fans}
$s(F_n)=f_{2\cdot n}$.
\end{thm}

\parit{Proof.}
Applying the deletion-plus-contraction formula, we can draw the following infinite diagram.
\begin{figure}[ht!]
\centering
\includegraphics{mppics/pic-36}
\end{figure}
(We ignore loops and end vertices since they do not change the number of spanning trees.)
In addition to the fans $F_n$ we use its variations $F_n'$, which differ from $F_n$ by an extra parallel edge.

Set $a_n=s(F_n)$ and $a'_n=s(F'_n)$.
From the diagram, we get the following two recursive relations:
\begin{align*}
a_{n+1}&=a'_n+a_n,
\\
a'_n&=a_n+a'_{n-1}.
\end{align*}
That is, in the sequence 
\[a_1,a_1',a_2,a_2',a_3\dots\]
every number starting from $a_2$ is the sum of the previous two.

Further note that $F_1$ has two vertices connected by a unique edge,
and  $F'_1$ has two vertices connected by a pair of parallel edges.
Hence $a_1=1=f_2$ and $a_1'=2=f_3$ and therefore 
\[a_n=f_{2\cdot n}\]
for any $n$.\qeds

\parbf{Comments.}
We can deduce a recursive relation for $a_n$, without using~$a_n'$:
\begin{align*}
a_{n+1}&=a_n'+a_n=
\\
&=2\cdot a_n+a'_{n-1}=
\\
&=3\cdot a_n-a_{n-1}.
\end{align*}
This is a special case of the so-called \index{constant-recursive sequences}\emph{constant-recursive sequences}.
The general term of constant-recursive sequences can be expressed by a closed formula ---
read \cite{jordan} if you wonder how.
In our case, it is
\[a_n=\tfrac1{\sqrt{5}}\cdot
\left(
(\tfrac{3+\sqrt{5}}2)^n-(\tfrac{3-\sqrt{5}}2)^n
\right).\]
Since $a_n$ is an integer and $0<\tfrac1{\sqrt{5}}\cdot(\tfrac{3-\sqrt{5}}2)^n<1$ for any $n\ge 1$, a shorter formula can be written
\[a_n
=
\left\lfloor\tfrac1{\sqrt{5}}\cdot(\tfrac{3+\sqrt{5}}2)^n\right\rfloor,\]
where $\lfloor x\rfloor$ denotes floor of $x$; 
that is, $\lfloor x\rfloor$ is the maximal integer that does not exceed $x$.

\begin{thm}{Exercise}\label{ex:zig-zag}
Consider the sequence of zig-zag graphs $Z_n$ of the following type:
\begin{figure}[ht!]
\centering
\includegraphics{mppics/pic-37}
\end{figure}

Show that $s(Z_n)=f_{2\cdot n}$ for any $n$. 
\end{thm}

\begin{thm}{Exercise}\label{ex:ladder}
Let us denote by $b_n$ the number of spanning trees in the \label{page:ladder}\index{ladder}\emph{$n$-step ladder} $L_n$; that is, in the graph of the following type:

\begin{figure}[ht!]
\centering
\includegraphics{mppics/pic-38}
\end{figure}

Apply the method we used for the fans $F_n$ to show that the sequence $b_n$ satisfies the following linear recursive relation:
\[b_{n+1}=4\cdot b_n-b_{n-1}.\]

\end{thm}

Note that $b_1=1$ and $b_2=4$; applying the exercise, we could calculate the first numbers of the sequence $(b_n)$:
\[1,4,15,56,209,780,2911,\dots \]

The following exercise is analogous, but more complicated.

\begin{thm}{Advanced exercise}\label{ex:wheel}
Recall that a wheel $W_n$ is the graph of following type:

\begin{figure}[ht!]
\centering
\includegraphics{mppics/pic-30}
\end{figure}

Show that the sequence $c_n=s(W_n)$ satisfies the following recursive relation:
\[c_{n+1}=4\cdot c_n-4\cdot c_{n-1}+c_{n-2}.\]

\end{thm}

Using the exercise above and applying induction, one can show that 
\[c_n=f_{2\cdot n+1}+f_{2\cdot n-1}-2=l_{2\cdot  n}-2\]
for any $n$.
The numbers $l_n=f_{n+1}+f_{n-1}$ are called \index{Lucas numbers}\emph{Lucas numbers};
they pop up in combinatorics as often as Fibonacci numbers.  

\section{Remarks}

The \textit{deletion-plus-contraction formula} together with Kirchhoff's rules was used in the solution of the so-called \index{squaring the square problem}\emph{squaring the square problem}.
The history of this problem and its solution are discussed in a book by Martin Gardiner \cite[Chapter 17]{gardiner}.

The proof of the recurrence relation above is given by Mohammad Hassan Shirdareh Haghighi and Khodakhast Bibak \cite{shirdareh-haghighi-bibak};
this problem is also discussed in the book by Ronald Graham, Donald Knuth, and Oren Patashnik~\cite{graham-knuth-patashnik}.
