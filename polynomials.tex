\chapter{Polynomials}

Counting problems often lead to specially organized data.
Sometimes it is convenient to \emph{pack} this data in a polynomial.
If this \emph{packing} is to be done in a smart way, then the algebraic structure of polynomial reflects the original combinatoric structure.

\section*{Chromatic polynomial}

Denote by $P_G(k)$ the number of colorings of the graph $G$ in $k$ colors such that the ends of each edge get different colors.

\begin{thm}{Exercise}
Assume that a graph $G$ has exactly two connected components $H_1$ and $H_2$.
Show that 
\[P_G(k)=P_{H_1}(k)\cdot P_{H_2}(k)\]
for any $k$.
\end{thm}

\begin{thm}{Exercise}
Show that for any integer $n\ge 3$,
\[P_{W_n}(k+1)=(k+1)\cdot P_{C_n}(k),\]
where $W_n$ denotes the wheel with $n$ spokes and $C_n$ is the cycle of length~$n$.
\end{thm}

\begin{thm}{Deletion-minus-contraction formula}\label{thm:deletion-minus-contraction}
For any edge $e$ in the pseudograph $G$ we have
\[P_G(k)=P_G\backslash e,k)-P_G/e,k).\]
\end{thm}

\parit{Proof.}
The valid colorings of $G\backslash e$ can be divided into two groups: 
(1) those where the ends of the edge $e$ get different colors --- these remain to be valid colorings of $G$ and (2) those where the ends of $e$ get the same color --- each of such colorings corresponds to unique coloring of $G/e$.
Hence
\[P_G\backslash e,k)=P_G(k)+P_G/e,k),\]
which is equivalent to the deletion-minus-contraction formula.
\qeds

Note that if the pseudograph $G$ has loops then $P_G(k)=0$ for any $k$.
Indeed in a valid coloring the ends of loop should get different colors, which is impossible.

The latter can be also proved using the deletion-minus-contraction formula.
Indeed, if $e$ is a loop in $G$, then $G/e=G\backslash e$;
therefore $P_G\backslash e,k)\z=P_G/e,k)$ and
\[P_G(k)=P_G\backslash e,k)-P_G/e,k) =0.\]

Similarly, removing a parallel edge from a pseudograph $G$ does not change $P_G(k)=0$.
Indeed, if $e$ is an edge of $G$ which has a parallel edge $f$ then in $G/e$ the edge $f$ becomes a loop.
Therefore $P_G/e,k)=0$ for any $k$ and by deletion-minus-contraction formula we get 
\[P_G(k)=P_G\backslash e,k).\]
The same identity can be seen directly --- any admissible coloring of $G\backslash e$ is also admissible in $G$ --- since the ends of $f$ get different colors, so does $e$. 

Summarizing above discussion:
the problem of finding $P_G(k)$ for a pseudograph $G$ can be reduced to the case when $G$ is a graph --- if $G$ has a parallel edge, removing it does not change $P_G(k)$ and if $G$ has a loop then $P_G(k)=0$ for all $k$.

Recall that polynomial $P$ of $k$ is an expression of the following type
\[P(k)=a_0+a_1\cdot k+\dots+a_n\cdot k^n,\]
with constants $a_0,\dots, a_n$, which are called \emph{coefficients} of the polynomial.
If $a_n\ne 0$, it is called \emph{leading coefficient} of $P$;
in this case $n$ is the degree of $P$.
If the leading coefficient is 1 then the polynomial is called \emph{monic}.

\begin{thm}{Theorem}\label{thm:chromatic-polynomial}
For any pseudograph $G$, there is a polynomial with integer coefficients $P$ such that 
\[P_G(k)=P(k)\]
for any $k$.
The polynomial $P$ is called \emph{chromatic polynomial} of the graph~$G$.

Moreover, if $G$ has a loop then $P_G(k)\equiv 0$;
otherwise $P$ is monic and has degree $p$,
where $p$ is the number of vertexes in~$G$.
\end{thm}

The deletion-minus-contraction formula will play the central role in the following proof.

\parit{Proof.}
As usual, denote by $p$ and $q$ the number of vertexes and edges in $G$.

To prove the first part, we will use the induction on $q$.

As the base case, consider the null graph $N_p$; that is, the graph with $p$ vertexes and no edges.
Since $N_p$ has no edges, any coloring of $N_p$ is admissible.
We have $k$ choices for each of $n$ vertexes therefore
\[P_{N_p}(k)=k^p.\]
In particular, the function $k\mapsto P_{N_p}(k)$ is given by monic polynomial of degree $p$ with integer coefficients.

Assume that the first statement holds for all pseudographs with at most $q-1$ edges.
Fix a graph $G$ with $q$ edges. 
Applying the deletion-minus-contraction formula for some edge $e$ in $G$, we get that
\[P_G(k)=P_G\backslash e,k)-P_G/e,k).\]
Note that the pseudographs $G\backslash e$ and $G/e$ have $q-1$ edges.
By induction hypothesis, $P_G\backslash e,k)=P(k)$ and $P_G/e,k)=Q(k)$ for some polynomials $P$ and $Q$ with integer coefficients.
Hence the same holds for their difference $P_G(k)=P(k)-Q(k)$.

To prove the second part, we also use the induction.

First note that if $G$ has a loop then $P_G(k)=0$ as $G$ has no valid colorings.

Assume that the chromatic polynomial of any multigraph $G$ with at most $q-1$ edges and at most $p$ vertexes is monic of degree $p$.

Fix a multigraph $G$ with $p$ vertexes and $q$ edges.
Note that $G\backslash e$ is a multigraph with $p$ vertexes and $q-1$ edges.
By the assumption, its chromatic polynomial $P$ is monic of degree $p$.

Further the pseudograph $G/e$ has $p-1$ vertexes,
and its chromatic polynomial $Q$ is either vanish or has degree $p-1$.
In both cases $P-Q$ is a monic polynomial of degree~$p$.
It remains to apply the deletion-minus-contraction formula, 
\[P_G(k)=P(k)-Q(k).\]
\qedsf

\begin{thm}{Advanced exercise}
Let $G$ be a graph with $p$ vertexes and $q$ edges.
Show that the coefficient in front of $k^{p-1}$ of its chromatic polynomial $P_G(k)$ equals to $(-1)^{p-1}\cdot q$.
\end{thm}

\parit{Hint:} Apply induction on $q$ and use the deletion-minus-contraction formula the same ways as in the proof of the theorem.

\begin{thm}{Exercise}
Use induction and  deletion-minus-contraction formula to show that 
\begin{enumerate}[(a)]
\item $P_{P_q}(k)=k\cdot(k-1)^q$ where $P_q$ denotes the path with $q$ edges;
\item $P_{T}(k)=k\cdot(k-1)^q$ for any tree $T$ with $q$ edges;
\item $P_{C_p}(k)=(k-1)^p+(-1)^p\cdot(k-1)$ for the cycle $C_p$ of length $p$.
\end{enumerate}
\end{thm}

\begin{thm}{Exercise}
Show that for any connected graph $G$ with $p$ vertexes we have 
\[P_G(k)\le k\cdot(k-1)^{p-1}\]
for any positive integer $k$.
\end{thm}

\begin{thm}{Advanced exercise} Show that graph $G$ is a tree if and only if \[P_G(k)= k\cdot(k-1)^{p-1}\] for some positive integer $p$.
\end{thm}

\begin{thm}{Exercise}
Show that 
\[P_{K_p}(k)=k\cdot(k-1)\cdots(k-p+1).\]

\end{thm}

Note that for any graph $G$ with $p$ vertexes we have
\[P_{K_p}(k)\le P_G(k)\le P_{N_p}(k)\]
for any $k$.
Since 
\begin{align*}
P_{K_p}(k)&=k\cdot(k-1)\cdots(k-p+1),
\intertext{and}
P_{N_p}(k)&=k^p,
\end{align*}
it follows that chromatic polynomial of $G$ is monic of degree $p$.
It gives an alternative way to prove the second statement in Theorem~\ref{thm:chromatic-polynomial}.

\begin{thm}{Exercise}
Construct a pair of nonisomorphic graphs with equal chromatic polynomials.
\end{thm}

\section*{Matching polynomial}

Recall that a \emph{matching} in a graph is a set of edges without common vertexes.

Given an integer $n\ge0$,
denote by $m_n=m_n(G)$ be the number of matchings with $n$ edges in the graph $G$.

Note that for a graph $G$ with $p$ vertexes and $q$ edges, we have 
$m_0(G)=1$, 
$m_1(G)=q$ and $m_n(G)=0$ if $2\cdot n>p$.
The maximal integer $k$ such that $m_k(G)\ne0$ is called \emph{matching number} of $G$.
The expression 
\[M_G(x)=m_0+m_1\cdot x+\dots +m_k\cdot x^k\]
is called \emph{matching polynomial} of $G$.

Matching polynomial $M_G(x)$ gives a convenient way to work with all the numbers $m_n(G)$ simultaneously.
The degree of $M_G(x)$ is the matching number of $G$ and
the total number of matching in $G$ is its value at $1$:  
\[M_G(1)=m_0+m_1+\dots +m_k.\]

\begin{wrapfigure}[9]{r}{40 mm}
\begin{lpic}[t(-6 mm),b(0 mm),r(0 mm),l(0 mm)]{pics/deletion-deletion(1)}
\lbl[tr]{4,10;$G$}
\lbl[tr]{28,19;$G\backslash e$}
\lbl[tr]{28,5;$G\backslash \bar e$}
\end{lpic}
\end{wrapfigure}

Assume $e$ is an edge in a graph $G$.
Recall that the graph $G\backslash e$ is obtained from $G$ by deleting $e$.
Let us denote by  $G\backslash \bar e$ the graph obtained from $G$ by deleting the vertexes of $e$ with all their edges; that is, if $e$ connects two vertexes $v$ and $w$ then 
\[G\backslash \bar e=G\backslash \{v,w\}.\]

The following exercise is analogous to the deletion-contraction formulas \ref{thm:deletion-minus-contraction} and \ref{thm:deletion-plus-contraction}.

\begin{thm}{Exercise}
Let $G$ be a graph
\begin{enumerate}[(a)]
\item\label{ex:deletion-deletion} Show that
\[M_G(x)=M_{G\backslash e}(x)+x\cdot M_{G\backslash \bar e}(x)\]
for any edge $e$ in $G$

\item\label{ex:deletion-deletion-K} Use part \ref{ex:deletion-deletion} to show that the matching polynomials of complete graphs satisfy the following recursive relation:
\[M_{K_{n+1}}(x)=M_{K_{n}}(x)+n\cdot x\cdot M_{K_{n-1}}(x).\]

\item Use \ref{ex:deletion-deletion-K} to calculate $M_{K_6}(x)$. 
\end{enumerate}

\end{thm}

\section*{Spanning-tree polynomial}

Consider a connected graph $G$ with the vertexes labeled by $x_1,\dots,x_n$;
let us treat each label $x_i$ as an independent variable.

For each spanning tree $T$ in $G$ consider the monomial 
\[x_1^{d_1-1}\cdots x_n^{d_n-1}\]
where $d_i$ denotes the degree of $i$-th vertex in $T$.

The tree $T$ has $n-1$ edges and therefore 
$d_1+\dots+d_n=2\cdot(n-1)$.
It follows that the sum of degrees of the monomial is $n-2$;
that is, our monomial has degree $n-2$.

The sum of these monomials is a polynomial of degree $n-2$ of $n$ variables $x_1,\dots, x_n$.
This polynomial will be called \emph{spanning-tree polynomial} and it will be denoted by 
$S_G(x_1,\dots,x_n)$.

Note that the total number of spanning trees in $G$ equals to the value
$S_G(1,\dots,1)$.
However, as it can be seen in the following exercise,
the polynomial $S_G$ keeps lot more information about spanning trees in $G$.

\begin{thm}{Exercise}
Let $G$ be a graph with vertexes labeled by $x_1,\dots,x_n$ and $S_G(x_1,\dots,x_n)$ be its spanning tree polynomial.
Show the following
\begin{enumerate}[(a)]
\item The value $S_G(0,1,\dots,1)$ can be interpreted as the number of spanning trees with the leaf $x_1$.
\item The coefficient of $S_G$ in front of a monomial 
\[x_1^{d_1-1}\cdots x_n^{d_n-1}\]
equals to the number of spanning trees in $G$ such that the vertex $x_i$ has degree $d_i$.
\item The coefficient of $S_G$ in front of $x_1\cdots x_{n-2}$ equals to the number of paths of length $n$ connecting $x_{n-1}$ and $x_{n}$.
\item The partial derivative
\[\tfrac{\partial}{\partial x_1}S_G(0,1,\dots,1)\]
is the numbers of spannig trees in $G$ for which have $x_1$ have degree 2.
\item The value 
\[\tfrac12\cdot\left(S_G(1,1,\dots,1)+ S_G(-1,1,\dots,1)\right)\]
is the numbers of spanig trees in $G$ for which have $x_1$ has odd degree.
\end{enumerate}
\end{thm}

The following theorem generalizes the Cayley formula (\ref{thm:cayley}).

\begin{thm}{Theorem} Assume that the vertexes of $K_n$ are labeled by $x_1,\dots,x_n$.
Then
$S_{K_n}(x_1,\dots,x_n)=(x_1+\dots x_n)^{n-2}$.

In particular,
\[s(K_n)=n^{n-2};\]
that is the number of spanning trees in $K_n$ is $n^{n-2}$.
\end{thm}

\parit{Proof.}
Let us apply induction on $n$;
the base case $n=1$ is evident.

Assume that the statement holds for $n-1$; that is,
\[S_{K_{n-1}}(x_1,\dots,x_{n-1})=(x_1+\dots+x_{n-1})^{n-3}\eqlbl{eq:S-K(n-1)}\]
Let us show that 
\[S_{K_n}(x_1,\dots,x_n)=(x_1+\dots+x_n)^{n-2}.\]

Note that $S_{K_{n}}$ is a homogeneous symmetric polynomial of degree $n-2$;
that is, each monomial in $S_{K_{n}}$ has degree $n-2$ and permutation of values $x_1,\dots x_n$ does not change the value $S_G(x_1,\dots,x_n)$.

Therefore it suffices to prove that all monomials in $S_{K_n}$ without $x_n$ sum up to $(x_1+\dots+x_{n-1})^{n-2}$.

Each of these monomials correspond to a spanning tree $T$ with $d_n=1$;
that is, the vertex $x_n$ is a leaf of $T$.
In other words, $T$ is a tree on the vertexes $x_1,\dots,x_{n-1}$ plus an edge from any of these vertexes to the vertex $x_n$. 
Summing up for all such trees we get 
\[S_{K_{n-1}}(x_1,\dots,x_{n-1})\cdot(x_1+\dots+x_{n-1}).\]
By \ref{eq:S-K(n-1)}, the latter equals to
\[(x_1+\dots+x_{n-1})^{n-2}\]
which proves the required statement.

To prove the last statement, it remains to note that 
\[s(G)=S_G(1,\dots,1)=(1+\dots+1)^{n-2}=n^{n-2}.\]
\qedsf

\begin{thm}{Exercise}
Assume that the vertexes of the left part of $K_{m,n}$ are labeled by $x_1,\dots,x_m$ and the vertexes in the right part are labeled by $y_1,\dots,y_n$. 
Show that
\[S_{K_n}(x_1,\dots,x_m,y_1,\dots,y_n)=(x_1+\dots +x_m)^{n-1}\cdot(y_1+\dots +y_n)^{m-1}.\]
In particular, 
\[s(K_{m,n})=m^{n-1}\cdot n^{m-1}.\]

\end{thm}

\parit{Hint:} Mimic the proof of theorem.

\section*{Remarks}

A very good expository paper on chromatic polynomials is writen by
Ronald Read; see \cite{read}. 
Matching polynomials are discussed in a paper of Christopher Godsil and Ivan Gutman; see \cite{godsil-gutman}.
Our discussion of spanning-tree polynomials is based of answer of Fedor Petrov \cite{petrov} to my question on mathoverflow; see  it is also closely relevant to the proof of Cayley formula given by Arthur Cayley himself \cite{cayley}. 